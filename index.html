<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Life Calendar - Your Life in Weeks</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono|Roboto:300,400,500" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://public.codepenassets.com/css/reset-2.0.min.css">
  
  <style>
    /* Global Styles */
    * {
      box-sizing: border-box;
      cursor: url("https://raw.githubusercontent.com/amal-sajeev/weekstolive/refs/heads/main/cursor.png") 32 32, default;
    }
    
    body {
      margin: 0;
      padding: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(120deg, #fdfdfd, #f8f9fa);
      color: #1a1a1a;
      overflow-x: hidden;
      transition: background 6s ease;
      height: 100vh;
      overflow: hidden;
    }
    
    /* Screen Transition Animations */
    .screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      pointer-events: none;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease, filter 0.4s ease;
      overflow-y: auto;
      filter: blur(6px);
    }
    
    .screen.active {
      opacity: 1;
      pointer-events: auto;
      transform: translateY(0);
      filter: blur(0);
    }
    
    /* Date Picker Screen Styles */
    .date-picker-screen {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font: 16px 'Roboto', sans-serif;
      background: #f8f9fa;
      animation: bgShift 12s ease-in-out infinite alternate;
      overflow: hidden;
      height: 100%;
      padding: 20px;
    }
    
    .date-picker-screen h1 {
      font-size: 2.5rem;
      font-weight: 300;
      margin-bottom: 1rem;
      text-align: center;
      color: #333;
      animation: fadeInDown 0.8s ease both;
    }
    
    .date-picker-screen .subtitle {
      font-size: 1.1rem;
      color: #666;
      margin-bottom: 1rem;
      text-align: center;
      animation: fadeIn 1s ease both 0.3s;
    }
    
    .center {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font: 16px 'Roboto', sans-serif;
      transform: scale(1.3);
      animation: zoomIn 0.6s ease both 0.6s;
      margin: 0.5rem 0;
    }
    
    .center .date {
      font-size: 30px;
      font-weight: 300;
      margin: 0.5rem 0;
      padding: 10px;
    }
    
    .center .date-picker {
      display: flex;
      padding: 30px;
      margin: 10px 0;
      overflow: hidden;
    }
    
    .center .day,
    .center .month,
    .center .year {
      position: relative;
      height: 50px;
      margin: 0 10px;
      border-top: 1px solid #0522f3;
      border-bottom: 1px solid #0522f3;
      border-radius: 0;
    }
    
    .center .day:before,
    .center .month:before,
    .center .year:before,
    .center .day:after,
    .center .month:after,
    .center .year:after {
      content: '';
      position: absolute;
      left: 0;
      width: 100%;
      height: 50px;
      background-color: #fff;
      opacity: 0.8;
      pointer-events: none;
      z-index: 1;
    }
    
    .center .day:before,
    .center .month:before,
    .center .year:before {
      top: -51px;
    }
    
    .center .day:after,
    .center .month:after,
    .center .year:after {
      bottom: -51px;
    }
    
    .center .day li,
    .center .month li,
    .center .year li {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 80px;
      height: 50px;
      -webkit-user-select: none;
         -moz-user-select: none;
          -ms-user-select: none;
              user-select: none;
      margin-left: -5px;
    }
    
    .continue-btn {
      width: 160px;
      height: 45px;
      border-radius: 25px;
      border: none;
      outline: none;
      color: white;
      background-color: #2466fb;
      box-shadow: 0 4px 20px rgba(36, 102, 251, 0.3);
      font-weight: 500;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 1rem;
      animation: fadeInUp 0.8s ease both 1s;
      position: relative;
      overflow: hidden;
    }
    
    .continue-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 25px rgba(36, 102, 251, 0.4);
    }
    
    .continue-btn::after {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.2);
      transform: skewX(-20deg);
      transition: left 0.5s ease;
    }
    
    .continue-btn:hover::after {
      left: 200%;
    }
    
    /* Life Calendar Screen Styles */
    .life-calendar-screen {
      padding: 20px;
      min-height: 100vh;
      background: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-y: auto;
    }
    
    .life-calendar-screen h1 {
      text-align: center;
      font-size: 28px;
      margin-bottom: 8px;
      margin-top: 60px;
      animation: fadeInDown 0.8s ease both;
    }
    
    .birth-info {
      text-align: center;
      margin-bottom: 20px;
      font-size: 16px;
      color: 666;
      animation: fadeIn 0.8s ease both 0.4s;
    }
    
    .back-btn {
      position: fixed;
      top: 20px;
      left: 20px;
      background: #2466fb;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-size: 14px;
      z-index: 1000;
      transition: all 0.2s ease;
      overflow: hidden;
    }
    
    .back-btn:hover {
      background: #1e56e8;
      transform: scale(1.05);
    }
    
    .reflection {
      text-align: center;
      font-size: 18px;
      font-style: italic;
      color: #444;
      margin-bottom: 25px;
      opacity: 0;
      transform: translateY(15px);
      transition: opacity 1.2s ease, transform 1.2s ease;
      animation: floatText 6s ease-in-out infinite;
    }
    
    .reflection.show {
      opacity: 1;
      transform: translateY(0);
    }

    /* Life Calendar Specific Styles */
    :root{
      --cell-size: 12px;
      --gap: 2px;
      --cols: 52;
      --rows: 90;
      --y-axis-width: 56px;
      --accent: #2466fb;
      --future: #f0f0f0;
      --tooltip-bg: #fff;
    }

    .wrap {
      display: grid;
      grid-template-columns: var(--y-axis-width) 1fr;
      grid-template-rows: auto 1fr;
      column-gap: 16px;
      align-items: start;
      justify-content: center;
      width: calc((var(--cols) * var(--cell-size)) + ((var(--cols) - 1) * var(--gap)) + var(--y-axis-width) + 16px);
      margin: 0 auto;
      opacity: 0;
      animation: fadeIn 1s ease forwards 0.8s;
    }

    .x-axis {
      grid-column: 2;
      grid-row: 1;
      display: grid;
      grid-template-columns: repeat(var(--cols), var(--cell-size));
      column-gap: var(--gap);
      width: calc( (var(--cols) * var(--cell-size)) + ((var(--cols)-1) * var(--gap)) );
      font-size: 11px;
      color: #333;
      margin-bottom: 8px;
    }
    
    .x-axis .tick {
      height: 18px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .y-axis {
      grid-column: 1;
      grid-row: 2;
      display: grid;
      grid-template-rows: repeat(var(--rows), var(--cell-size));
      row-gap: var(--gap);
      height: calc( (var(--rows) * var(--cell-size)) + ((var(--rows)-1) * var(--gap)) );
      align-content: start;
    }
    
    .y-axis .label {
      display:flex;
      align-items:center;
      justify-content:flex-end;
      padding-right:8px;
      font-size:12px;
      color:#3b3b3b;
    }

    .grid-container {
      grid-column: 2;
      grid-row: 2;
      display: grid;
      grid-template-columns: repeat(var(--cols), var(--cell-size));
      grid-template-rows: repeat(var(--rows), var(--cell-size));
      column-gap: var(--gap);
      row-gap: var(--gap);
      width: calc( (var(--cols) * var(--cell-size)) + ((var(--cols)-1) * var(--gap)) );
      background: transparent;
      padding-bottom: 6px;
    }

    .cell {
      width: var(--cell-size);
      height: var(--cell-size);
      border-radius: 2px;
      border: 1px solid #d5d5d5;
      background: var(--future);
      transition: background 160ms ease, transform 120ms ease;
      box-sizing: border-box;
    }
    
    .cell:hover{ 
      transform: translateY(-2px); 
      box-shadow: 0 6px 10px rgba(0,0,0,0.08); 
    }

    .cell.lived { 
      background: var(--accent); 
      border-color: rgba(0,0,0,0.06); 
    }
    
    .cell.current {
      outline: 2px solid gold;
      outline-offset: -2px;
      box-shadow: 0 0 12px rgba(255,200,60,0.45);
      animation: pulse 2s infinite;
    }

    .tooltip {
      position: fixed;
      pointer-events: none;
      background: var(--tooltip-bg);
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 8px 10px;
      font-size: 13px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.10);
      opacity: 0;
      transform: translateY(-6px) scale(0.95);
      transition: opacity 160ms ease, transform 160ms ease;
      z-index: 9999;
      color:#111;
    }
    
    .tooltip.show { 
      opacity: 1; 
      transform: translateY(0) scale(1);
    }

    .legend {
      display:flex;
      justify-content:center;
      gap:18px;
      margin-top: 12px;
      font-size: 13px;
      color:#222;
      animation: fadeIn 0.8s ease both 1s;
    }
    
    .legend .item { 
      display:flex; 
      gap:8px; 
      align-items:center; 
    }
    
    .legend .sw { 
      width:16px; 
      height:16px; 
      border-radius:3px; 
      border:1px solid #cfcfcf; 
    }
    
    .sw.l { background:var(--accent); }
    .sw.f { background:var(--future); }

    /* Animation Keyframes */
    @keyframes fadeIn { 
      from { opacity:0; } 
      to { opacity:1; } 
    }
    
    @keyframes fadeInUp { 
      from { opacity:0; transform:translateY(20px); } 
      to { opacity:1; transform:translateY(0); } 
    }
    
    @keyframes fadeInDown { 
      from { opacity:0; transform:translateY(-20px); } 
      to { opacity:1; transform:translateY(0); } 
    }
    
    @keyframes zoomIn { 
      from { opacity:0; transform:scale(0.8); } 
      to { opacity:1; transform:scale(1.3); } 
    }

    @keyframes floatText {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); box-shadow: 0 0 12px rgba(255,200,60,0.45); }
      50% { transform: scale(1.08); box-shadow: 0 0 20px rgba(255,200,60,0.6); }
    }

    @keyframes bgShift {
      0% { background: #f8f9fa; }
      100% { background: #eef2f7; }
    }

    /* Responsive adjustments */
    @media (max-width: 920px) {
      :root { 
        --cell-size: 10px; 
        --y-axis-width: 48px; 
      }
      .x-axis .tick { 
        font-size: 10px; 
      }
      .center { 
        transform: scale(1.1); 
      }
      .date-picker-screen h1 { 
        font-size: 2rem; 
      }
    }

    @media (max-height: 700px) {
      .date-picker-screen {
        justify-content: flex-start;
        padding-top: 2vh;
      }
      
      .date-picker-screen h1 {
        font-size: 1.8rem;
        margin-bottom: 0.8rem;
      }
      
      .date-picker-screen .subtitle {
        font-size: 1rem;
        margin-bottom: 0.8rem;
      }
      
      .center {
        transform: scale(1);
        margin: 0.2rem 0;
      }
      
      .center .date {
        font-size: 24px;
        margin: 0.3rem 0;
      }
      
      .center .date-picker {
        padding: 10px 15px;
        margin: 5px 0;
      }
      
      .continue-btn {
        margin-top: 0.8rem;
        height: 40px;
      }
    }

    @media (max-height: 500px) {
      .date-picker-screen h1 {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
      }
      
      .date-picker-screen .subtitle {
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
      }
      
      .center {
        transform: scale(0.9);
      }
      
      .center .date {
        font-size: 20px;
      }
      
      .center .date-picker {
        padding: 5px 10px;
      }
      
      .center .day,
      .center .month,
      .center .year {
        height: 40px;
        margin: 0 8px;
      }
      
      .center .day li,
      .center .month li,
      .center .year li {
        height: 40px;
        width: 70px;
      }
      
      .continue-btn {
        height: 36px;
        font-size: 14px;
        width: 140px;
      }
    }
  </style>
</head>
<body>
  <!-- Date Picker Screen -->
  <div class="screen date-picker-screen active" id="datePickerScreen">
    <h1>Your Life in Weeks</h1>
    <p class="subtitle">Select your birth date to visualize your life journey</p>
    
    <div class="center" id="datePickerApp">
      <!-- React app will render here -->
    </div>
    
    <button class="continue-btn" id="continueBtn">View My Life</button>
  </div>

  <!-- Life Calendar Screen -->
  <div class="screen life-calendar-screen" id="lifeCalendarScreen">
    <button class="back-btn" id="backBtn">← Change Date</button>
    
    <h1>Your Life in Weeks</h1>
    <div class="birth-info" id="birthInfo"></div>
    <div class="reflection" id="lifeReflection"></div>

    <div class="wrap">
      <div class="x-axis" id="xAxis"></div>
      <div class="y-axis" id="yAxis"></div>
      <div class="grid-container" id="lifeGrid"></div>
    </div>

    <div class="legend">
      <div class="item"><div class="sw l"></div><div>Lived weeks</div></div>
      <div class="item"><div class="sw f"></div><div>Future weeks</div></div>
    </div>
  </div>

  <div id="tooltip" class="tooltip"></div>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/react/16.4.0/umd/react.production.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/react-dom/16.4.0/umd/react-dom.production.min.js'></script>
  
  <script>
    // Global variables to store selected date
    let selectedDate = new Date();
    
    // Original React Date Picker Component from input.html
    function _defineProperty(obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true });
      } else {
        obj[key] = value;
      }
      return obj;
    }

    const { Component, Fragment } = React;

    const MONTHS = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'July', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];
    const YEARS = new Array(201).fill(1900).map((value, index) => value + index);

    class CustomWheel extends Component {
      constructor({ selected }) {
        super();
        
        _defineProperty(this, "onMouseDown", event => {
          this.previousY = event.touches ? event.touches[0].clientY : event.clientY;
          this.dragging = true;

          document.addEventListener('mousemove', this.onMouseMove);
          document.addEventListener('mouseup', this.onMouseUp);
          document.addEventListener('touchmove', this.onMouseMove);
          document.addEventListener('touchend', this.onMouseUp);
        });
        
        _defineProperty(this, "onMouseMove", event => {
          let clientY = event.touches ? event.touches[0].clientY : event.clientY;
          this.offset = clientY - this.previousY;
          let maxPosition = -this.props.data.length * 50;
          let position = this.state.position + this.offset;
          this.setState({ position: Math.max(maxPosition, Math.min(50, position)) });
          this.previousY = event.touches ? event.touches[0].clientY : event.clientY;
        });
        
        _defineProperty(this, "onMouseUp", () => {
          // calculate closeset snap
          let maxPosition = -(this.props.data.length - 1) * 50;
          let rounderPosition = Math.round((this.state.position + this.offset * 5) / 50) * 50;
          let finalPosition = Math.max(maxPosition, Math.min(0, rounderPosition));

          this.dragging = false;
          this.setState({ position: finalPosition });

          document.removeEventListener('mousemove', this.onMouseMove);
          document.removeEventListener('mouseup', this.onMouseUp);
          document.removeEventListener('touchmove', this.onMouseMove);
          document.removeEventListener('touchend', this.onMouseUp);

          this.props.onDateChange(this.props.type, -finalPosition / 50);
        });
        
        _defineProperty(this, "onWheel", event => {
          event.preventDefault();
          // Determine scroll direction (positive = scroll down, negative = scroll up)
          let delta = event.deltaY > 0 ? -50 : 50;
          let maxPosition = -(this.props.data.length - 1) * 50;
          let newPosition = this.state.position + delta;
          let finalPosition = Math.max(maxPosition, Math.min(0, newPosition));
          this.setState({ position: finalPosition });
          this.props.onDateChange(this.props.type, -finalPosition / 50);
        });

        this.state = { position: selected ? -(selected - 1) * 50 : 0 };
        this.offset = 0;
        this.dragging = false;
      }

      componentDidUpdate() {
        let selectedPosition = -(this.props.selected - 1) * 50;
        if (!this.dragging && this.state.position !== selectedPosition) {
          this.setState({ position: selectedPosition });
        }
      }

      render() {
        let inlineStyle = {
          willChange: 'transform',
          transition: `transform ${Math.abs(this.offset) / 100 + 0.1}s`,
          transform: `translateY(${this.state.position}px)`
        };

        return React.createElement("div", { 
          className: "dragdealer year", 
          onMouseDown: this.onMouseDown, 
          onTouchStart: this.onMouseDown,
          onWheel: this.onWheel 
        }, React.createElement("ul", { className: "handle", style: inlineStyle },
        this.props.data.map(item => React.createElement("li", { key: item }, item))));
      }
    }

    class DatePicker extends Component {
      constructor(...args) {
        super(...args);
        
        _defineProperty(this, "dateChanged", (type, changedData) => {
          let newDate;

          if (type === 'day') {
            newDate = new Date(this.props.date.getFullYear(), this.props.date.getMonth(), changedData + 1);
          } else if (type === 'month') {
            let maxDayInSelectedMonth = new Date(this.props.date.getFullYear(), changedData + 1, 0).getDate();
            let day = Math.min(this.props.date.getDate(), maxDayInSelectedMonth);
            newDate = new Date(this.props.date.getFullYear(), changedData, day);
          } else if (type === 'year') {
            let maxDayInSelectedMonth = new Date(1900 + changedData, this.props.date.getMonth() + 1, 0).getDate();
            let day = Math.min(this.props.date.getDate(), maxDayInSelectedMonth);
            newDate = new Date(1900 + changedData, this.props.date.getMonth(), day);
          }

          this.props.onDateChange(newDate);
        });
      }

      render() {
        this.days = new Array(new Date(this.props.date.getFullYear(), this.props.date.getMonth() + 1, 0).getDate())
          .fill(1)
          .map((value, index) => value + index);

        this.months = MONTHS;
        this.years = YEARS;

        return React.createElement("div", { className: "date-picker" },
          React.createElement(CustomWheel, { type: "day", data: this.days, selected: this.props.date.getDate(), onDateChange: this.dateChanged }),
          React.createElement(CustomWheel, { type: "month", data: this.months, selected: this.props.date.getMonth() + 1, onDateChange: this.dateChanged }),
          React.createElement(CustomWheel, { type: "year", data: this.years, selected: this.props.date.getYear() + 1, onDateChange: this.dateChanged })
        );
      }
    }

    class App extends Component {
      constructor(...args) {
        super(...args);
        
        _defineProperty(this, "state", { date: new Date() });
        
        _defineProperty(this, "dateChanged", newDate => {
          this.setState({ date: newDate });
          selectedDate = newDate; // Update global selected date
        });
      }

      render() {
        return React.createElement(Fragment, null,
          React.createElement("div", { className: "date" }, 
            this.state.date.getDate(), " ", 
            MONTHS[this.state.date.getMonth()], " ", 
            this.state.date.getFullYear()
          ),
          React.createElement(DatePicker, { date: this.state.date, onDateChange: this.dateChanged })
        );
      }
    }

    function showReflection() {
    const lines = [
      "You have fewer summers left than you think. How will you spend the next one?",
      "Every week is a brick in the wall of your life — are you building a fortress or a prison?",
      "What if you only had 1,000 weeks left — would you live today differently?",
      "Your calendar is finite. Your attention even more so.",
      "Seneca said: 'It is not that we have a short time to live, but that we waste a lot of it.'",
      "Each square is a chance — will you trade it for scrolling or for living?",
      "Time is the one currency you can't earn back. How are you spending it?",
      "This grid is your story in weeks. Which chapter are you in?",
      "Imagine your life as a novel — are you proud of this chapter?",
      "The future is a blank grid. What do you want to color in?"
    ];

    const reflection = document.getElementById('lifeReflection');
    reflection.textContent = lines[Math.floor(Math.random() * lines.length)];

    // Trigger fade-in
    setTimeout(() => reflection.classList.add('show'), 100);
  }


    // Life Calendar Code
    const COLS = 52;
    const ROWS = 90;

    function buildXAxis() {
      const xAxis = document.getElementById('xAxis');
      xAxis.innerHTML = '';
      for(let c = 1; c <= COLS; c++) {
        const d = document.createElement('div');
        d.className = 'tick';
        if (c === 1 || c === COLS || c % 5 === 0) d.textContent = c;
        xAxis.appendChild(d);
      }
    }

    function buildYAxis() {
      const yAxis = document.getElementById('yAxis');
      yAxis.innerHTML = '';
      for(let r = 0; r < ROWS; r++) {
        const cell = document.createElement('div');
        cell.className = 'label';
        if (r % 5 === 0) cell.textContent = r;
        else cell.textContent = '';
        yAxis.appendChild(cell);
      }
    }

    function buildGrid() {
      const lifeGrid = document.getElementById('lifeGrid');
      const tooltip = document.getElementById('tooltip');
      
      lifeGrid.innerHTML = '';
      for(let age = 0; age < ROWS; age++) {
        for(let week = 0; week < COLS; week++) {
          const idx = age * COLS + week;
          const cell = document.createElement('div');
          cell.className = 'cell';
          cell.dataset.age = age;
          cell.dataset.week = (week + 1);
          cell.dataset.index = idx + 1;
          
          cell.addEventListener('mouseenter', (e) => {
            tooltip.innerHTML = `<strong>Age:</strong> ${age} <span style="margin:0 6px">•</span> <strong>Week:</strong> ${week+1}<br><small>Absolute week # ${idx+1}</small>`;
            positionTooltip(e);
            tooltip.classList.add('show');
          });
          
          cell.addEventListener('mousemove', (e) => { positionTooltip(e); });
          cell.addEventListener('mouseleave', () => { tooltip.classList.remove('show'); });
          lifeGrid.appendChild(cell);
        }
      }
    }

    function positionTooltip(e) {
      const tooltip = document.getElementById('tooltip');
      const pad = 12;
      const tooltipWidth = 160; // Approximate tooltip width
      const tooltipHeight = 40; // Approximate tooltip height
      
      // Get viewport dimensions
      const viewportWidth = window.innerWidth;
      const viewportHeight = window.innerHeight;
      
      // Calculate initial position (bottom-right by default)
      let x = e.clientX + pad;
      let y = e.clientY + pad;
      
      // Check if tooltip would go off the right edge
      if (x + tooltipWidth > viewportWidth - 10) {
        x = e.clientX - tooltipWidth - pad; // Position on the left
      }
      
      // Check if tooltip would go off the bottom edge
      if (y + tooltipHeight > viewportHeight - 10) {
        y = e.clientY - tooltipHeight - pad; // Position above cursor
      }
      
      // Additional check: if cursor is near the top-left corner
      // and tooltip would go off both edges, use special positioning
      if (e.clientX < tooltipWidth + 20 && e.clientY < tooltipHeight + 20) {
        x = e.clientX + pad;
        y = e.clientY + pad;
      }
      
      tooltip.style.left = x + 'px';
      tooltip.style.top = y + 'px';
    }

    function markLivedWeeks(birthDate) {
      const cells = document.getElementById('lifeGrid').children;
      
      for(let i = 0; i < cells.length; i++) {
        cells[i].classList.remove('lived', 'current');
      }
      
      if (!birthDate || isNaN(birthDate)) return;

      const now = new Date();
      const diffMs = now - birthDate;
      const weeksLived = Math.floor(diffMs / (1000*60*60*24*7));
      
      for(let i = 0; i < cells.length; i++) {
        if (i < weeksLived) cells[i].classList.add('lived');
        else cells[i].classList.remove('lived');
      }
      
      const curIndex = Math.max(0, Math.min(cells.length - 1, weeksLived - 1));
      if (curIndex >= 0 && curIndex < cells.length) {
        cells[curIndex].classList.add('current');
      }
    }

    function showLifeCalendar() {
      // Hide date picker screen with animation
      document.getElementById('datePickerScreen').classList.remove('active');
      
      // Show life calendar screen with animation after a small delay
      setTimeout(() => {
        document.getElementById('lifeCalendarScreen').classList.add('active');
        
        // Update birth info
        const birthInfo = document.getElementById('birthInfo');
        birthInfo.textContent = `Born on ${selectedDate.toLocaleDateString('en-US', { 
          year: 'numeric', 
          month: 'long', 
          day: 'numeric' 
        })}`;
        
        // Build and render life calendar
        buildXAxis();
        buildYAxis();
        buildGrid();
        markLivedWeeks(selectedDate);
        showReflection();
      }, 100);
    }

    function showDatePicker() {
      // Hide life calendar screen with animation
      document.getElementById('lifeCalendarScreen').classList.remove('active');
      
      // Show date picker screen with animation after a small delay
      setTimeout(() => {
        document.getElementById('datePickerScreen').classList.add('active');
      }, 100);
    }

    // Initialize the React date picker
    ReactDOM.render(React.createElement(App, null), document.getElementById('datePickerApp'));

    // Event listeners
    document.getElementById('continueBtn').addEventListener('click', showLifeCalendar);
    document.getElementById('backBtn').addEventListener('click', showDatePicker);

    // Adjust date picker screen on resize
    window.addEventListener('resize', function() {
      const datePickerScreen = document.getElementById('datePickerScreen');
      if (datePickerScreen.classList.contains('active')) {
        // Force reflow to ensure proper rendering
        datePickerScreen.style.display = 'none';
        datePickerScreen.offsetHeight; // Trigger reflow
        datePickerScreen.style.display = 'flex';
      }
    });
  </script>
</body>
</html>